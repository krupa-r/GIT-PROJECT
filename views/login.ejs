<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login Page</title>
    <link rel="stylesheet" href="styles.css">
</head>    
    <body>
        <div class ="login-container">
            <h2>Login</h2>
            <form class="login-form" action="users/login" method="post">
                <input type="text" name="name" placeholder="Username" required>
                <input type="password" name="password" placeholder="Password" required>
                <button type="submit" id="submit-button">Login</button>
            </form>

            <script>
const submitButton = document.getElementById('submit-button');

submitButton.addEventListener('click', async (event) => {
  event.preventDefault(); // Prevent the default form submission behavior
  
  const username = document.querySelector('input[name="name"]').value;
  const password = document.querySelector('input[name="password"]').value;

  try {
    const response = await fetch('/users/login', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ name: username, password }), // Corrected 'name' to 'username'
    });

    if (!response.ok) {
      // Handle non-200 status codes (e.g., 400)
      if (response.status === 400) {
        alert('Invalid credentials. Please try again.');
      } else {
        alert(`An error occurred: ${response.status}`);
      }
    } else {
     window.location.href = '/';
      console.log('Login successful!');
    }
  } catch (error) {
    console.error(error);
    alert('Something went wrong. Please try again later.');
  }
});
</script>
        </div>
    </body>
</html>